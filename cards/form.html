<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Credit Card Form</title>
  <style>
    :root{--bg:#f6f8fb;--card:#ffffff;--accent:#2563eb;--muted:#6b7280}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial; background:var(--bg);color:#111827}
    .page{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{background:var(--card);padding:20px;border-radius:12px;box-shadow:0 6px 18px rgba(17,24,39,0.06);width:380px}
    h1{font-size:18px;margin:0 0 12px}
    form{display:grid;gap:12px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    .input{display:flex;align-items:center;background:#f9fafb;border:1px solid #e6e9ef;padding:10px;border-radius:8px}
    input[type="text"], input[type="password"], input[type="tel"]{border:0;background:transparent;outline:none;font-size:15px;width:100%}
    .row{display:flex;gap:10px}
    .col{flex:1}
    .helper{font-size:12px;color:var(--muted)}
    .actions{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
    button{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
    button:disabled{opacity:0.5;cursor:not-allowed}
    .small-btn{background:transparent;border:0;color:var(--accent);cursor:pointer;padding:6px;border-radius:6px}
    .error{color:#dc2626;font-size:13px}
    .cc-icon{width:36px;height:24px;display:inline-block;margin-left:8px;opacity:0.85}
    .vis-toggle{background:transparent;border:0;font-size:13px;color:var(--muted);cursor:pointer}
    .foot{font-size:12px;color:var(--muted);margin-top:10px}
  </style>
</head>
<body>
  <div class="page">
    <div class="card" role="region" aria-label="Credit card payment form">
      <h1>Payment details</h1>
      <form id="ccForm" action="/process-payment" method="POST" autocomplete="on" novalidate>
        <input type="hidden" name="invoice_number" value="{{.InvoiceNumber}}" />
        <input type="hidden" name="callback_url" value="{{.CallbackURL}}" />

        <div>
          <label for="ccNumber">Card number</label>
          <div class="input">
            <input id="ccNumber" name="ccNumber" type="tel" inputmode="numeric" autocomplete="cc-number" placeholder="1234 5678 9012 3456" maxlength="23" aria-describedby="ccHelp" required />
            <div class="cc-icon" id="brand"></div>
          </div>
          <div id="ccHelp" class="helper">We accept Visa, MasterCard, Amex.</div>
        </div>

        <div class="row">
          <div class="col">
            <label for="exp">Expiration (MM/YY)</label>
            <div class="input">
              <input id="exp" name="exp" type="tel" inputmode="numeric" autocomplete="cc-exp" placeholder="MM/YY" maxlength="5" required />
            </div>
          </div>

          <div style="width:120px;">
            <label for="cvv">CVV</label>
            <div class="input" style="justify-content:space-between">
              <input id="cvv" name="cvv" type="password" inputmode="numeric" autocomplete="cc-csc" placeholder="•••" maxlength="4" style="letter-spacing:0.35em;" required />
              <button type="button" class="vis-toggle" id="toggleCvv" aria-pressed="false" aria-label="Show CVV">Show</button>
            </div>
          </div>
        </div>

        <div id="error" class="error" role="alert" aria-live="polite" style="display:none"></div>

        <div class="actions">
          <div class="helper">Secure payment</div>
          <button id="submit" type="submit">Pay</button>
        </div>
      </form>
      <div class="foot">This is a demo form — do not enter real card details.</div>
    </div>
  </div>

  <script>
    const onlyDigits = s => s.replace(/\D/g, '');

    const ccNumber = document.getElementById('ccNumber');
    const exp = document.getElementById('exp');
    const cvv = document.getElementById('cvv');
    const toggleCvv = document.getElementById('toggleCvv');
    const errorEl = document.getElementById('error');
    const brandEl = document.getElementById('brand');

    function formatCardNumber(value) {
      const digits = onlyDigits(value);
      if (/^3[47]/.test(digits)) {
        const part1 = digits.slice(0,4);
        const part2 = digits.slice(4,10);
        const part3 = digits.slice(10,15);
        return [part1,part2,part3].filter(Boolean).join(' ');
      }
      return digits.match(/.{1,4}/g)?.join(' ')?.slice(0,19) || digits;
    }

    function detectBrand(digits){
      if (/^4/.test(digits)) return 'Visa';
      if (/^5[1-5]/.test(digits)) return 'MasterCard';
      if (/^3[47]/.test(digits)) return 'American Express';
      return '';
    }

    ccNumber.addEventListener('input', ()=>{
      const formatted = formatCardNumber(ccNumber.value);
      ccNumber.value = formatted;
      const digits = onlyDigits(formatted);
      const brand = detectBrand(digits);
      brandEl.textContent = brand;
    });

    exp.addEventListener('input', ()=>{
      let v = onlyDigits(exp.value).slice(0,4);
      if (v.length >= 3) v = v.slice(0,2) + '/' + v.slice(2);
      exp.value = v;
    });

    toggleCvv.addEventListener('click', ()=>{
      const isHidden = cvv.type === 'password';
      cvv.type = isHidden ? 'text' : 'password';
      toggleCvv.textContent = isHidden ? 'Hide' : 'Show';
      toggleCvv.setAttribute('aria-pressed', String(!isHidden));
    });
  </script>
</body>
</html>

